# tank-software-design

## О проекте
Учебный проект по проектированию и дизайну ПО

## Сборка и запуск
```powershell
./gradlew.bat classes --warning-mode all
./gradlew.bat run
```

## Загрузка уровня
- Из файла: `src/main/resources/level.txt` с символами `T` (дерево), `X` (старт игрока), `_` (пусто).
- Случайно: если файла нет или запущено с `-Dlevel.mode=random` (или переменная окружения `LEVEL_MODE=random`).
- Принудительно из файла: `-Dlevel.mode=file` (или `LEVEL_MODE=file`).

Пример файла:

```
___T__T___
__TT__TTTT
_________T
TTTT__T__T
_____X____
__________
```

## Ключевые дефолтные пакеты
- `ru.mipt.bit.platformer` — игровые сущности (танк, дерево, поле, стартовый загрузчик).
- `ru.mipt.bit.platformer.util` — вспомогательные тулзы для работы с тайлами и графикой.

## Хронология домашек
### 2025-10-29
- Добавлены случайно генерируемые танки-боты, которые двигаются случайно (AI). Введены правила занятости клеток и проверка границ уровня. Покрыто тестами логику без графики.
	- Количество ботов настраивается: `-Dbots=5` или переменная окружения `BOTS=5`.

### 2025-10-27
- Добавлена загрузка уровня двумя способами: из файла `level.txt` и случайный генератор. Поддержка нескольких препятствий и случайной стартовой позиции.

### 2025-10-16
- Исправлены нарушения OCP и DIP через введение интерфейсов GameObject, Obstacle, Renderable и перенаправление зависимостей на абстракции.
- Затронутые классы:
	- `GameObject` — создан интерфейс игрового объекта с позицией.
	- `Obstacle` — создан интерфейс препятствия (наследует GameObject).
	- `Renderable` — создан интерфейс отрисовываемого объекта.
	- `TankModel` — реализует GameObject.
	- `TreeObstacleModel` — реализует Obstacle.
	- `Tank` — реализует Renderable.
	- `TreeObstacle` — реализует Renderable.
	- `InputHandler` — зависит от абстракций Obstacle вместо конкретной TreeObstacleModel.
	- `GameDesktopLauncher` — использует интерфейс Renderable для дерева.

### 2025-10-06
- Разделены модели и графика для всех сущностей, обработка ввода вынесена в InputHandler с поддержкой расширения (добавлена стрельба по Space), написаны unit-тесты.
- Затронутые классы:
	- `Direction` — убраны клавиши, добавлен метод vector() для получения вектора направления.
	- `TankModel` — создана модель танка без графики.
	- `TreeObstacleModel` — создана модель дерева без графики.
	- `Tank` — переписан на использование TankModel, отвечает только за рендер.
	- `TreeObstacle` — переписан на использование TreeObstacleModel.
	- `InputHandler` — создан обработчик ввода с поддержкой команд (движение, стрельба).
	- `GameDesktopLauncher` — использует модели и InputHandler.
	- `TankModelTest` — unit-тесты модели танка (инициализация позиции, старт движения, поворот на месте, обновление прогресса, блокировка повторного старта во время движения, получение скорости).
	- `TreeObstacleModelTest` — unit-тесты модели дерева (установка позиции, проверка занятости клетки, начальное состояние).
	- `build.gradle` — добавлена зависимость JUnit 5.

### 2025-09-21
- Вынесены абстракции танка, дерева, поля и направлений, убран copy-paste в обработке ввода.
- Затронутые классы:
	- `Direction` — создано перечисление направлений и горячих клавиш.
	- `Tank` — создана сущность игрока с логикой движения, поворота и рендера.
	- `TreeObstacle` — создано представление препятствия-дерева и его рендер.
	- `GameField` — создана оболочка над картой, слоем и `TileMovement`.
	- `GameDesktopLauncher` — переписана инициализация/обработка ввода с использованием новых абстракций.